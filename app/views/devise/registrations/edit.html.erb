<div class="authform">
  <h3>Edit <%= resource_name.to_s.humanize %></h3>
  <%= form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => { :method => :put, :role => 'form'}) do |f| %>
    <%= devise_error_messages! %>
    <div class="form-group">
      <% if current_user.provider.nil? %>
        <%= f.label :email %>
        <%= f.email_field :email, :autofocus => true, class: 'form-control' %>
        <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
          <div>Currently waiting confirmation for: <%= resource.unconfirmed_email %></div>
        <% end %>
      <% else %>
        <%= f.hidden_field :email %>

        <p>Email Address</p>
        <h4><%= current_user.email %></h4>
        <p> your account is linked to Facebook.  You cannot change the email address, but you can change the username displayed on JCastle
        </p>
      <% end %>
    </div>
    <div class="form-group">
      <%= f.label :name %>
      <%= f.email_field :name, class: 'form-control' %>
    </div>
      <% if current_user.provider.nil? %>
        <%= link_to user_omniauth_authorize_path(:facebook), class: "label round" do %>
        <i class="fi-social-facebook"> </i> Enable Facebook Login
        <% end %> 

        <span data-tooltip class="has-tip" title="Click here to link your Jcastle account to your Facebook account.  Jcastle will not post to Facebook but you can login with Facebook instead of remembering your email/password for Jcastle. Your email address above must be the same as your Facebook email address. If you wish to change your email address please do so first and update changes before enabling Facebook login.">?</span>
      <% end %> 

      <%= f.submit 'Update Login Info', :class => 'button right' %>

    <fieldset>
      <h5>Change your password</h5>
      <div class="form-group">
        <%= f.label :password %>
        <%= f.password_field :password, :autocomplete => 'off', class: 'form-control' %>
      </div>
      <div class="form-group">
        <%= f.label :password_confirmation %>
        <%= f.password_field :password_confirmation, class: 'form-control' %>
      </div>
      <p>You must enter your current password to make changes.</p>
      <div class="form-group">
        <%= f.label :current_password %>
        <%= f.password_field :current_password, class: 'form-control' %>
      </div>
    </fieldset>
    <%= f.submit 'Change Password', :class => 'button right' %>
  <% end %>
</div>
<div class="authform">
<h3>Cancel Account</h3>
<p>Unhappy? We'll be sad to see you go.</p>
<%= button_to "Cancel my account", registration_path(resource_name), :data => { :confirm => "Are you sure?" }, :method => :delete, :class => 'button right' %>
</div>
